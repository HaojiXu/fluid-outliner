(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{668:function(e,t,n){"use strict";n.r(t);var i=n(12),o=n(11),r=n(624),s=n.n(r),a=n(18),l=n(40),d=n.n(l),p=n(2),c=n(16),g=n(0),u=n.n(g),h=n(36),b=n(28),f=n.n(b),y=(n(622),n(139)),m=n(20);const v=Object(y.DragSource)("Node",{beginDrag:e=>({id:e.node.id,index:e.index}),isDragging:(e,t)=>!(!t||t.getItem().id!==e.node.id),endDrag:(e,t)=>{t&&t.didDrop()||e.completeDrop(null)}},(e,t)=>({connectDragSource:e.dragSource(),isDragging:t.isDragging()})),E=Object(y.DropTarget)("Node",{hover(e,t,n){if(!t)return;if(!n)return;const i=t.getItem(),o=i.index,r=e.index,s=e.node.id,a=i.id;if(s===a)return;if(e.node.hasDescendent(a))return;const l=Object(m.findDOMNode)(n).getBoundingClientRect(),d=(l.bottom-l.top)/2,p=t.getClientOffset().y-l.top;if(o<r){if(p<d)return;e.setPotentialDropTarget({id:s,location:"above"})}if(o>r){if(p>d)return;e.setPotentialDropTarget({id:s,location:"below"})}},drop(e,t){if(!t)return;const n=t.getItem();n&&e.completeDrop(n.id)}},(e,t)=>({connectDropTarget:e.dropTarget(),isOver:t.isOver()}));n.d(t,"NodeEditorInner",function(){return k}),n.d(t,"NodeEditor",function(){return j});var C=function(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},x=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},D=function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}l((i=i.apply(e,t||[])).next())})};const w=Object(h.asyncComponent)({resolve:()=>D(void 0,void 0,void 0,function*(){return(yield Promise.all([n.e(5),n.e(6)]).then(n.bind(null,672))).QuillEditor})}),O=({dir:e})=>u.a.createElement("div",{style:{height:"30px"}},u.a.createElement("div",{style:{border:"1px solid silver",borderRadius:"4px",background:"#ddd",float:"right",color:"black",marginTop:"5px",paddingLeft:"5px"}},u.a.createElement(f.a,{name:`triangle-${e}`})));let k=class extends u.a.Component{constructor(){super(...arguments),this.container=null,this.editor=null,this.isEditing=!1}render(){const{classes:e}=this.props,t={};return this.props.willDrop?t.borderColor="red":this.isEditing&&(t.borderColor="#9473cd"),this.props.connectDropTarget(u.a.createElement("div",{style:{paddingLeft:40+40*this.props.level+"px"},className:e.container,onKeyDown:this.handleKeyDown,tabIndex:0,onDoubleClick:this.enableEditing,ref:this.registerContainer},"above"===this.props.willDrop&&u.a.createElement(O,{dir:"down"}),u.a.createElement(i.n,{className:e.paper,style:t},this.props.node.children.length>0&&u.a.createElement(f.a,{name:this.props.isCollapsed?"unfold":"fold",className:`${e.collapseControl} ${this.props.isCollapsed?e.unfoldControl:e.foldControl}`,onClick:this.toggleCollapse}),this.props.connectDragSource(u.a.createElement("span",null,u.a.createElement(f.a,{name:"grabber",className:e.grabber}))),this.renderContent(),u.a.createElement(i.b,{variant:"fab",color:"primary",size:"small",className:e.editBubble,onClick:this.props.node.addSibling},u.a.createElement(s.a,null))),"below"===this.props.willDrop&&u.a.createElement(O,{dir:"up"})))}focus(){this.container&&this.container.focus()}registerContainer(e){this.container=e}toggleCollapse(){this.props.toggleCollapse(this.props.node.id)}disableEditing(){this.isEditing=!1}enableEditing(){this.isEditing=!0}renderContent(){const{node:e,classes:t}=this.props;return this.isEditing?u.a.createElement(w,{theme:"bubble",forwardedRef:this.registerEditor,value:e.content,onChange:this.handleChange,className:t.editor,onBlur:this.disableEditing}):u.a.createElement("div",{style:{padding:"12px 15px"},className:"ql-container ql-editor",dangerouslySetInnerHTML:{__html:e.content}})}handleKeyDown(e){let t=!1;const{node:n}=this.props;if(this.isEditing)"esc"===d()(e.nativeEvent)&&(this.isEditing=!1,this.container.focus());else{switch(d()(e.nativeEvent)){case"enter":e.shiftKey?n.addSibling():this.isEditing=!0,t=!0;break;case"delete":n.outline.removeNode(n.id),t=!0;break;case"tab":e.shiftKey?n.indentBackward():n.indentForward(),t=!0;break;case"esc":this.isEditing=!1,t=!0;break;case"up":e.ctrlKey?this.props.isCollapsed||this.props.toggleCollapse(n.id):e.shiftKey?n.moveUp():this.props.focusUp(this.props.index),t=!0;break;case"down":e.ctrlKey?this.props.isCollapsed&&this.props.toggleCollapse(n.id):e.shiftKey?n.moveDown():this.props.focusDown(this.props.index),t=!0}t&&(e.stopPropagation(),e.preventDefault())}}registerEditor(e){this.editor=e,this.editor&&this.editor.focus()}handleChange(e){this.props.node.setContent(e)}};C([p.u,x("design:type",Object)],k.prototype,"isEditing",void 0),C([a.a,x("design:type",Function),x("design:paramtypes",[Object]),x("design:returntype",void 0)],k.prototype,"registerContainer",null),C([a.a,x("design:type",Function),x("design:paramtypes",[]),x("design:returntype",void 0)],k.prototype,"toggleCollapse",null),C([a.a,x("design:type",Function),x("design:paramtypes",[]),x("design:returntype",void 0)],k.prototype,"disableEditing",null),C([a.a,x("design:type",Function),x("design:paramtypes",[]),x("design:returntype",void 0)],k.prototype,"enableEditing",null),C([a.a,x("design:type",Function),x("design:paramtypes",[Object]),x("design:returntype",void 0)],k.prototype,"handleKeyDown",null),C([a.a,x("design:type",Function),x("design:paramtypes",[Object]),x("design:returntype",void 0)],k.prototype,"registerEditor",null),C([a.a,x("design:type",Function),x("design:paramtypes",[String]),x("design:returntype",void 0)],k.prototype,"handleChange",null),k=C([c.c],k);const j=Object(o.withStyles)({container:{paddingRight:"40px",outline:0,"&:hover $editBubble, &:hover $foldControl, &:hover $grabber":{display:"block"},"&:focus $paper":{borderColor:"#d7b2f5"}},paper:{position:"relative",borderRadius:0,cursor:"pointer",minHeight:"45px",border:"1px solid transparent","& .ql-tooltip":{zIndex:1e3}},editor:{zIndex:1},collapseControl:{position:"absolute",left:"-35px",top:"7px",fontSize:"2rem",color:"silver"},foldControl:{display:"none"},unfoldControl:{display:"block"},editBubble:{minWidth:"0px",position:"absolute",left:"5px",bottom:"-20px",width:"30px",height:"30px",lineHeight:"20px",minHeight:"0",padding:"0",zIndex:100,display:"none",paddingTop:"2px"},grabber:{position:"absolute",right:"-45px",top:"7px",color:"silver",fontSize:"2rem",display:"none"}})(v(E(k)))}}]);